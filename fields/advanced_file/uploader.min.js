function size_format(e){var l=!1;return quant=[{unit:"TB",mag:1099511627776},{unit:"GB",mag:1073741824},{unit:"MB",mag:1048576},{unit:"kB",mag:1024},{unit:"B ",mag:1}],quant.forEach(function(a){parseFloat(e)>=a.mag&&0==l&&(l=e/a.mag,l=e>1048576?l.toFixed(2):Math.round(l),l=l+" "+a.unit)}),l}function handleFileSelect(e,l){if(e.stopPropagation(),e.preventDefault(),e.dataTransfer)a=e.dataTransfer.files;else var a=e.target.files;for(var i=[],t="valid",r=0;r<a.length;r++){var f="fl"+Math.round(0xaa7fca0bf1f1*Math.random()),s=1,o="";l.allowed.length&&l.allowed.indexOf(a[r].type)<0&&(s=0,o=l.notices.invalid_filetype),l.max_size&&a[r].size>l.max_size&&(s=0,o=l.notices.file_exceeds_size_limit),a[r].size||(s=0,o=l.notices.zero_byte_file),ef_uploader_filelist[e.target.id+"_file_"+f]={file:a[r],state:s,field:l.id,message:o}}for(var r in ef_uploader_filelist)if(ef_uploader_filelist[r].field===l.id){var d="";0===ef_uploader_filelist[r].state&&(d="has-error"),i.push('<li class="ef-uploader-queue-item '+r+" "+d+'">','<a href="#remove-file" data-file="'+r+'" class="ef-file-remove">&times;</a> <span class="file-name">',ef_uploader_filelist[r].file.name,"</span>&nbsp;",'<div class="progress-bar" style="background:#ececec;"><div class="bar" id="progress-file-'+r+'" style="height:2px;width:0%;background:#a3be5f;"></div></div>','<small class="file-type">',ef_uploader_filelist[r].file.type||"n/a","</small> ",'<small class="file-size">'+size_format(ef_uploader_filelist[r].file.size)+"</small>",'<small class="file-error">'+ef_uploader_filelist[r].message+"</small>","</li>"),ef_uploader_filelist[r].message.length&&(t=ef_uploader_filelist[r].message)}e.target.value=null,document.getElementById(e.target.id+"_file_list").innerHTML='<ul class="ef-adv-preview-list">'+i.join("")+"</ul>",jQuery("#"+e.target.id+"_validator").val(t)}function handleDragOver(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}function handleDragOver(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}var ef_uploader_filelist={};jQuery(function(e){e(document).on("click",".ef-uploader-trigger",function(){var l=e(this);e("#"+l.data("parent")).trigger("click")}),e(".ef-multi-uploader").hide(),e(document).on("click",".ef-file-remove",function(l){l.preventDefault();var a=e(this),i=a.closest(".ef-adv-preview-list"),t=a.closest(".ef-multi-uploader-list").data("field"),r=a.closest(".ef-multi-uploader-list").data("id"),f=e("#"+r+"_validator");f.val(""),e('[data-parent="'+t+'"]').show(),delete ef_uploader_filelist[a.data("file")],a.closest(".ef-multi-uploader-list").parent().find(".ef-uploader-trigger").show(),a.parent().remove(),i.children().length||i.remove();for(var s in ef_uploader_filelist)ef_uploader_filelist[s].field===r&&ef_uploader_filelist[s].message.length&&f.val(ef_uploader_filelist[s].message)}),e(document).on("change",".ef-multi-uploader",function(l){var a=e(this),i=a.data("config");i.id=a.prop("id"),a.prop("multiple")||("object"!=typeof ef_uploader_filelist&&(ef_uploader_filelist={}),a.parent().find(".ef-uploader-trigger").hide()),handleFileSelect(l,i)})});